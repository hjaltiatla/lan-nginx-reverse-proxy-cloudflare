server {
  # Bind to localhost + all interfaces (IPv4 + IPv6)
  listen 127.0.0.1:8080;
  listen 0.0.0.0:8080;
  listen [::]:8080;

  server_name _;

  # allow container localhost + your LAN
  allow 127.0.0.1;
  allow 192.168.144.0/24;
  deny  all;

  # health endpoint for Docker / host checks
  location = /healthz {
    add_header Content-Type text/plain;
    return 200 "ok\n";
  }

  # everything else -> HTTPS
  location / {
    return 301 https://$host$request_uri;
  }
}
